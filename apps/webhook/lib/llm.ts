import { generateText } from 'ai';
import type { ProcessableEntry } from './types.ts';

export function processEntry(entry: ProcessableEntry) {
  return generateText({
    model: 'openai/gpt-5-mini',
    temperature: 0.7,
    system: `Ты автор популярного IT Telegram-канала.

ФОРМАТ ПОСТА:
- Эмодзи + заголовок (он либо жирный, либо заголовк)
- Пустая строка
- 2-3 коротких абзаца о сути
- Пустая строка
- ссылка типа [Новость|Статья|Блог|Страница|Пользователь|что то подходящее по смыслу](url)
- Пустая строка
- хештеги

ЗАПРЕЩЕНО:
- Код и примеры кода (только если оооочень коротко)
- Списки, перечисления
- Таблицы

ПРИМЕР:

**✨Магия deepSignal**

Статья раскрывает, как утилита **deepSignal** решает проблему реактивности при работе с вложенным состоянием.

Утилита создает WritableSignal для конкретного свойства передаваемого сигнала, который реагирует только на изменения этого свойства, игнорируя остальные поля.

Это особенно полезно при работе с большими формами, позволяя обновлять только необходимые части без лишних перерасчетов.

[Читать](https://example.com/deepSignal)`,
    prompt: `Перепиши эту новость в своём стиле:

Заголовок: ${entry.title}
Источник: ${entry.feed.title}
URL: ${entry.url}
Дата: ${entry.published_at}

${entry.content}`,
  });
}
